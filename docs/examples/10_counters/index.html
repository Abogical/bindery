<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Using Configuration</title>
  <link rel="stylesheet" type="text/css" href="style.css" />
</head>

<body>
  <script type="text/javascript" src="/bindery/js/bindery.umd.js"></script>
  <script>
    const {
      makeBook,
      PageBreak,
      FullBleedPage,
      FullBleedSpread,
      RunningHeader,
      Counter,
      PageReference
    } = Bindery;

    makeBook({
      content: {
        url: '../example_shared/content.html',
        selector: ".content",
      },
      rules: [
        PageBreak({ selector: 'h2', position: 'before', continue: 'right' }),
        FullBleedPage({ selector: '.med-figure' }),
        FullBleedSpread({ selector: '.big-figure', continue: 'same' }),
        RunningHeader(),
        Counter({
          incrementEl: 'h2',
          replaceEl: 'h2',
          replace: (el, counterValue) => {
            el.insertAdjacentHTML('beforeend', `<span style='color: lime;'>Title ${counterValue} </span>`);
            return el;
          }
        }),
        Counter({
          incrementEl: 'p',
          replaceEl: 'p',
          resetEl: 'h2',
          replace: (el, counterValue) => {
            el.insertAdjacentHTML('afterbegin', `<span style='color: red;'>P ${counterValue} </span>`);
            return el;
          }
        }),
        Counter({
          incrementEl: 'figure',
          replaceEl: 'figcaption',
          resetEl: 'h2',
          replace: (el, counterValue) => {
            el.insertAdjacentHTML('afterbegin', `<span style='color: blue;'>Fig ${counterValue} </span>`);
            return el;
          }
        }),
        PageReference({
          selector: ".toc a",
          replace: (element, number) => {
            let row = document.createElement('div');
            row.innerHTML = `${element.textContent}`;
            row.innerHTML += `<span style='float: right;'>${number}</span>`;
            return row;
          }
        }),
      ],
    });
  </script>

  <script type="text/javascript" src='/bindery/js/viewSourceButton.js'></script>
</body>
</html>
